---
title: '[ìš°í…Œì½”]ë ˆë²¨1 ì§€í•˜ì²  ë…¸ì„ ë„ ê´€ë¦¬ SPA step2 í›„ê¸°'
date: 2021-04-28
category: 'ìš°ì•„í•œ í…Œí¬ì½”ìŠ¤'
draft: false
---

<p align="middle" >
  <img width="200px;" src="https://github.com/yujo11/javascript-subway/raw/step1-component/src/images/subway_emoji.png"/>
</p>
<h2 align="middle">level1 - ì§€í•˜ì²  ë…¸ì„ ë„ ê´€ë¦¬ SPA</h2>
<p align="middle">Browser History APIë¥¼ ì´ìš©í•´ êµ¬í˜„í•˜ëŠ” ì§€í•˜ì²  ë…¸ì„ ë„ ê´€ë¦¬ SPA</p>

## 0. êµ¬í˜„ ìš”êµ¬ì‚¬í•­

## ğŸ¯ğŸ¯ step2

### ì§€í•˜ì² ì—­ ê´€ë¦¬ ê¸°ëŠ¥

- [x] ì§€í•˜ì² ì—­ì„ ë“±ë¡í•  ìˆ˜ ìˆë‹¤.
  - [x] ì—”í„°í‚¤ ë˜ëŠ” ë§ˆìš°ìŠ¤ í´ë¦­ìœ¼ë¡œ ì—­ì„ ì¶”ê°€í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
  - [x] ì¤‘ë³µëœ ì§€í•˜ì² ì—­ì€ ì¶”ê°€í•  ìˆ˜ ì—†ë‹¤.
  - [x] ì§€í•˜ì² ì—­ì€ 2ê¸€ì ì´ìƒ, 20ì ì´í•˜ì—¬ì•¼ í•œë‹¤.
- [x] ì§€í•˜ì² ì—­ì˜ ì´ë¦„ì„ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.
  - [x] ìˆ˜ì •í•˜ëŠ” UIëŠ” modalì„ ì´ìš©í•˜ì—¬ ìˆ˜ì •í•  ìˆ˜ ìˆê²Œ í•œë‹¤.
- [x] ì§€í•˜ì² ì—­ì„ ì‚­ì œí•  ìˆ˜ ìˆë‹¤.
  - [x] ì‚­ì œ ì‹œ confirmì„ ì´ìš©í•˜ì—¬ í•œ ë²ˆ ë” ìœ ì €ê°€ í™•ì¸í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
  - [x] ì´ë¯¸ ë…¸ì„ ì— ë“±ë¡ëœ ì—­ì¸ ê²½ìš° ì‚­ì œí•  ìˆ˜ ì—†ë‹¤.

### ì§€í•˜ì²  ë…¸ì„  ê´€ë¦¬ ê¸°ëŠ¥

- [x] ì§€í•˜ì²  ë…¸ì„ ì„ ë“±ë¡í•  ìˆ˜ ìˆë‹¤.
  - [x] ì¤‘ë³µëœ ì§€í•˜ì²  ë…¸ì„  ì´ë¦„ì´ ë“±ë¡ë  ìˆ˜ ì—†ë‹¤.
  - [x] ì§€í•˜ì²  ë…¸ì„ ì˜ ì´ë¦„ì€ 2ê¸€ì ì´ìƒ, 10ê¸€ì ì´í•˜ì—¬ì•¼ í•œë‹¤.
  - [x] ì§€í•˜ì²  ë…¸ì„  ìƒì„±ì‹œ í•„ìš”í•œ ê°’ì€ ìƒ‰ìƒ, ìƒí–‰ì—­, í•˜í–‰ì—­, (ìµœì´ˆ ìƒí–‰ì—­ê³¼ í•˜í–‰ì—­ êµ¬ê°„ì˜)ê±°ë¦¬, ì‹œê°„ì´ë‹¤.
- [x] ì§€í•˜ì²  ë…¸ì„ ì„ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.
  - [x] ì§€í•˜ì²  ë…¸ì„ ì˜ ì´ë¦„, ìƒí–‰ì—­, í•˜í–‰ì—­, ê±°ë¦¬, ì‹œê°„, ìƒ‰ìƒì„ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.
- [x] ì§€í•˜ì²  ë…¸ì„ ì„ ì‚­ì œí•  ìˆ˜ ìˆë‹¤.
- [x] ì§€í•˜ì²  ë…¸ì„  ë¦¬ìŠ¤íŠ¸ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.

### ì§€í•˜ì²  êµ¬ê°„ ê´€ë¦¬ ê¸°ëŠ¥

- [x] ì§€í•˜ì²  ë…¸ì„ ì— êµ¬ê°„ì„ ì¶”ê°€, ìˆ˜ì •, ì‚­ì œí•  ìˆ˜ ìˆë‹¤.
  - ì§€í•˜ì²  ë…¸ì„ ì— êµ¬ê°„ì„ ì¶”ê°€í•˜ëŠ” ê¸°ëŠ¥ì€ ë…¸ì„ ì— ì—­ì„ ì¶”ê°€í•˜ëŠ” ê¸°ëŠ¥ì´ë¼ê³ ë„ í•  ìˆ˜ ìˆë‹¤.
  - ì—­ê³¼ ì—­ì‚¬ì´ë¥¼ êµ¬ê°„ì´ë¼ í•˜ê³  ì´ êµ¬ê°„ë“¤ì˜ ëª¨ìŒì´ ë…¸ì„ ì´ë‹¤.
  - í•˜ë‚˜ì˜ ì—­ì€ ì—¬ëŸ¬ê°œì˜ ë…¸ì„ ì— ì¶”ê°€ë  ìˆ˜ ìˆë‹¤.
  - ì—­ê³¼ ì—­ ì‚¬ì´ì— ìƒˆë¡œìš´ ì—­ì´ ì¶”ê°€ ë  ìˆ˜ ìˆë‹¤.
  - ë…¸ì„ ì—ì„œ ê°ˆë˜ê¸¸ì€ ìƒê¸¸ ìˆ˜ ì—†ë‹¤.
- [x] êµ¬ê°„ ì¡°íšŒ ì‹œ, ë…¸ì„ ì„ ë³€ê²½í•˜ë©´ í•´ë‹¹ ë…¸ì„ ì˜ Colorë¡œ Select ì—˜ë¦¬ë¨¼íŠ¸ì˜ ë°°ê²½ìƒ‰ì„ ë³€ê²½í•œë‹¤.

### ì§€í•˜ì²  ë…¸ì„  ì „ì²´ë³´ê¸° ê¸°ëŠ¥

- [x] ì „ì²´ë³´ê¸° ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì „ì²´ ë…¸ì„ ì„ ë³¼ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.

## 2. ì½”ë“œ ë¦¬ë·° ë° í”¼ë“œë°± ğŸ“

### 2-1. í•¨ìˆ˜ì˜ ìœ„ì¹˜

![](./images/subway/step2-util.png)

ì»´í¬ë„ŒíŠ¸ ë‹¨ìœ„ë¡œ ì½”ë“œë¥¼ ë¶„ë¦¬í–ˆëŠ”ë° íŠ¹ì • ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ ì“°ì´ì§€ ì•ŠëŠ”(ë²”ìš©ì„± ìˆëŠ”) í•¨ìˆ˜ê°€ íŠ¹ì • ì»´í¬ë„ŒíŠ¸ì˜ ë©”ì„œë“œë¡œ ì¡´ì¬í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.

ì¬ì‚¬ìš©ì„±ê³¼ í•¨ìˆ˜ì˜ ì—­í• ì— ëŒ€í•œ ë¶€ë¶„ì„ ì¢€ ë” ê³ ë¯¼í•˜ë©´ì„œ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ê² ë‹¤ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤.

### 2-2. tokenì˜ ìœ„ì¹˜

![](./images/subway/step2-token.png)

ì»´í¬ë„ŒíŠ¸ ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•œ Classë“¤ì— ë‹¤ìŒê³¼ ê°™ì€ ë¡œì§ì´ ì¤‘ë³µì ìœ¼ë¡œ ìˆ˜í–‰ë˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.

```js
async render(token, sortedSectionList = []) {
    $('main').innerHTML = token ? subwayMapTemplate(sortedSectionList) : LOGIN_REQUIRED_TEMPLATE;
}
```

ë§¤ë²ˆ ì»´í¬ë„ŒíŠ¸ì—ì„œ renderë¡œì§ì„ ìˆ˜í–‰í•  ë•Œ tokenì„ ê²€ì¦í•˜ê³  ê·¸ì— ë”°ë¥¸ ë¡œì§ì„ ìˆ˜í–‰í•˜ê²Œ í•œ ê²ƒì…ë‹ˆë‹¤.

ì‚¬ì‹¤ ì´ëŸ° ì„¤ê³„ê°€ ë‚˜ì˜¤ê²Œ ëœ ë°°ê²½ì—ëŠ” service layerì˜ ì˜ëª»ëœ ë¶„ë¦¬ë„ ì¡´ì¬í–ˆìŠµë‹ˆë‹¤.

service layerì—ì„œ APIìš”ì²­ì„ ë³´ë‚¼ ë•Œ ë‹¤ìŒê³¼ ê°™ì´ tokenì„ ì™¸ë¶€ì—ì„œ ë„˜ê²¨ë°›ê³  ìˆì—ˆìŠµë‹ˆë‹¤.

```js
 isValidToken: async (token) => {
    try {
      await API.getUserInfo(token);

      return true;
    } catch (err) {
      console.error(err);
      return false;
    }
  },
```

service ë¡œì§ì—ì„œ tokenì„ ìš”êµ¬í•˜ë‹ˆ ì´ service ë¡œì§ì„ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë“¤ì´ tokenì„ ì•Œê³  ìˆì–´ì•¼ í•˜ëŠ” ìƒí™©ì´ ì™”ê³  ì•…ìˆœí™˜ì˜ ë°˜ë³µìœ¼ë¡œ ë¹„ìŠ·í•œ ë¡œì§ì„ ë˜í’€ì´í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.

service ë¡œì§ tokenì„ ìì²´ì ìœ¼ë¡œ ì–»ì–´ì˜¤ë„ë¡ í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì¤‘ë³µë˜ëŠ” ì½”ë“œë“¤ì„ ëŒ€í­ ì¤„ì¼ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

ê¸°ì¡´ componentì—ë§Œ ìœ„ì„í–ˆë˜ renderë¥¼ ë‹¤ìŒê³¼ ê°™ì´ token ìœ ë¬´ì— ë”°ë¼ Appì—ì„œë„ ì§ì ‘ ë Œë”í•˜ë„ë¡ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.

```js
// ê¸°ì¡´

this.router = {
  '/': (token = '') => this.Main.load(token),
  '/stations': (token = '') => this.Stations.load(token),
  '/lines': (token = '') => this.Lines.load(token),
  '/sections': (token = '') => this.Sections.load(token),
  '/map': (token = '') => this.SubwayMap.load(token),
  '/login': (token = '') => this.Login.load(token),
  '/signup': (token = '') => this.Signup.load(token),
}

await this.router[pathName]?.()

// ë³€ê²½ í›„
this.router = {
  '/': () => this.Main.load(),
  '/stations': () => this.Stations.load(),
  '/lines': () => this.Lines.load(),
  '/sections': () => this.Sections.load(),
  '/map': () => this.SubwayMap.load(),
  '/login': () => this.Login.load(),
  '/signup': () => this.Signup.load(),
}

token ? await this.router[pathName]?.() : this.render()
```

ì•„ì§ ì „ì²´ ì½”ë“œë¥¼ ì„¤ê³„í•˜ê³  ì±…ì„ê³¼ ì—­í• ì„ ë¶„ë¦¬ì‹œí‚¤ëŠ” ì¼ì€ ì‰½ì§€ ì•Šë‹¤. ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸° ì „ layer ë¶„ë¦¬ì— ëŒ€í•´ ê³ ë¯¼í•˜ë©´ì„œ ê° layerì˜ ì±…ì„ê³¼ ì—­í• ì„ ëª…í™•íˆ í•˜ìëŠ” ìƒê°ì„ í–ˆìŠµë‹ˆë‹¤.

## 3. ì½”ë“œ êµ¬ì¡° ì‹œê°í™” ğŸ”

![](./images/subway/step2-visual.png)

## 4. ë™ì‘ í™”ë©´(GIF) ğŸ¥

![](./images/subway/step2-demo.gif)

## 5. ë§í¬ ğŸ”—

- [ì „ì²´ ì½”ë“œ ë§í¬](https://github.com/yujo11/javascript-subway/tree/step2)
- [PR ë§í¬](https://github.com/woowacourse/javascript-subway/pull/57)
